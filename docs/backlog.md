# Project Backlog

Technical debt, improvements, and future work items identified during development.

## Priority Legend
- **P1**: Critical - blocks other work
- **P2**: High - should be addressed soon
- **P3**: Medium - address when convenient
- **P4**: Low - nice to have

---

## Technical Debt

| ID | Date | Priority | Type | Description | Source | Status |
|----|------|----------|------|-------------|--------|--------|
| TD-001 | 2025-12-06 | P2 | Infrastructure | **Set up frontend testing framework** - Frontend has no Jest, Vitest, or React Testing Library configured. All frontend component tests are currently blocked. Should be addressed at end of Epic P3-3 or start of next phase. Recommended: Vitest + React Testing Library for consistency with modern React patterns. | Story P3-3.4 Code Review | Done |

---

## Improvements

| ID | Date | Priority | Type | Description | Source | Status |
|----|------|----------|------|-------------|--------|--------|
| IMP-001 | 2025-12-06 | P4 | Code Quality | Remove console.log debug statements from EventCard.tsx (lines 104, 107) before production deployment | Story P3-3.4 Code Review | Done |

---

## Future Features

| ID | Date | Priority | Type | Description | Source | Status |
|----|------|----------|------|-------------|--------|--------|
| FF-001 | 2025-12-08 | P3 | Troubleshooting | **Log Viewer UI** - Simple dashboard page to view and download logs for troubleshooting. Features: (1) View last 24 hours of backend logs, (2) Filter by log level (ERROR, WARNING, INFO, DEBUG), (3) Search/filter by text, (4) Download logs as file, (5) Auto-refresh option. Implementation: Store logs in SQLite or file rotation, add /api/v1/system/logs endpoint, build React component in Settings page. | User Request | Done |
| FF-002 | 2025-12-08 | P2 | UX | **Events Page Real-time Updates** - Add refresh capability to events page so new events appear without manual page reload. Options: (1) Manual refresh button with loading indicator, (2) WebSocket subscription to EVENT_CREATED messages (backend already broadcasts these), (3) Auto-refresh toggle with configurable interval. Recommended: Use existing WebSocket infrastructure - subscribe to EVENT_CREATED and prepend new events to list. | User Request | Done |
| FF-003 | 2025-12-08 | P2 | UX | **Show Camera Name on Event Cards** - Event cards currently display camera_id (UUID) instead of the human-readable camera name. Update EventCard component to show camera.name for better identification. Backend API already includes camera_name in EVENT_CREATED WebSocket messages and event responses - just need to use it in the frontend display. | User Request | Done |
| FF-004 | 2025-12-08 | P2 | Performance | **Move Camera Preview to Cameras Page** - Dashboard currently shows live camera previews which generates significant network traffic (frame polling). Move the live preview grid to the Cameras page instead. Dashboard should show only camera status info (name, online/offline, last event) without live video streams. This reduces API chatter when users are just viewing the main dashboard. | User Request | Won't Fix |
| FF-005 | 2025-12-08 | P3 | UX | **Mobile Navigation - Top Bar Only** - On mobile devices, show navigation only at the top of the page instead of sidebar. Hide the sidebar on small screens and use a hamburger menu or horizontal nav bar to clean up the interface and maximize content area. Use Tailwind responsive breakpoints (md:hidden, lg:block) to toggle between mobile top nav and desktop sidebar. | User Request | Done |
| FF-006 | 2025-12-08 | P2 | UX | **Dashboard Real-time Stats Update** - When a new event is created, update the "Total Events" and "Current Activity" cards on the dashboard in real-time. Subscribe to EVENT_CREATED WebSocket messages and increment counters without requiring page refresh. Can be implemented alongside FF-002 (Events Page Real-time Updates) using same WebSocket subscription pattern. | User Request | Done |
| BUG-001 | 2025-12-08 | P2 | Bug | **Export JSON/CSV Buttons Failing** - The export buttons on the events page are not working. Investigate and fix the /api/v1/events/export endpoint or frontend export functionality. Check: (1) API endpoint returning correct data format, (2) Frontend correctly calling export endpoint, (3) File download handling in browser. | User Report | Done |
| BUG-002 | 2025-12-08 | P3 | Bug | **Motion Events Not Captured from Protect** - Pure motion events (without smart detection) are not being captured. Investigation shows that `is_motion_currently_detected` flag is separate from `is_smart_detected` in Protect WebSocket. When smart detection occurs (person/vehicle), motion flag is False. Options: (1) Treat smart detections AS motion events (they all involve motion), (2) Add separate motion event polling, (3) Accept that smart detections are the primary event type and update camera config UI to clarify this. Note: This may be expected behavior - Protect prioritizes smart detection over raw motion. | Investigation | Done |
| FF-007 | 2025-12-08 | P3 | Feature | **Selective Backup/Restore Options** - Add granular selection for both backup and restore operations. Backup: Allow users to choose which components to include via checkboxes: (1) Database (events, cameras, alert rules), (2) Thumbnails/media files, (3) System settings, (4) AI provider configuration (API keys), (5) Protect controller config. Restore: Parse backup file to show available components, let user select which parts to restore (e.g., restore only settings without overwriting events). | User Request | Done |
| FF-008 | 2025-12-08 | P2 | DevOps | **Installation Script & Setup Wizard** - Create executable install script to automate application setup. Script should: (1) Check/install Python 3.11+, Node.js 18+, (2) Create virtual environment and install backend dependencies, (3) Install frontend dependencies and build, (4) Initialize database with migrations, (5) Generate encryption key, (6) Create systemd/launchd service files, (7) Configure reverse proxy (nginx) template. Manual setup items to document: (a) AI provider API keys (OpenAI, Gemini, Claude, Grok), (b) UniFi Protect controller credentials, (c) RTSP camera URLs and credentials, (d) SSL certificates for HTTPS, (e) Firewall/port forwarding for remote access. Include first-run setup wizard in UI for manual config items. | User Request | Done |
| IMP-002 | 2025-12-10 | P3 | UX | **Clean Up Event Card Duplicative Stats** - Event cards display redundant information that clutters the UI. Remove or consolidate duplicative stats including: (1) Confidence scoring shown in multiple places, (2) Identification/objects detected items that repeat, (3) Other redundant metadata. Streamline the event card layout to show essential info once in a clean, scannable format. | User Request | Done |
| FF-009 | 2025-12-10 | P2 | Feature | **Save & Display Multi-Frame Event Frames** - For events analyzed with multi-frame mode, persist the extracted frames so users can review them. Implementation: (1) Save key frames to filesystem alongside thumbnails during analysis, (2) Store frame paths/metadata in event record, (3) Add frame gallery UI when event card is expanded/selected, (4) Show frames in sequence with timestamps. This provides transparency into what the AI analyzed and helps users understand multi-frame descriptions. Note: Story P3-7.5 "Display Key Frames Gallery on Event Detail" in sprint-status covers similar scope. | User Request | Done |
| IMP-003 | 2025-12-10 | P3 | UX | **Remove Top Navigation on Desktop** - On desktop mode, the top navigation bar is redundant since the sidebar provides full navigation. Hide the top nav bar on larger screens (lg: breakpoint and above) to maximize content area and reduce visual clutter. Keep top nav visible only on mobile/tablet where sidebar is hidden. Use Tailwind responsive classes (lg:hidden) on the top nav component. | User Request | Done |
| FF-010 | 2025-12-10 | P2 | Feature | **Multi-Select Delete on Events Page** - Add ability to select multiple events and delete them in bulk. Implementation: (1) Add checkbox to each event card for selection, (2) Add "Select All" checkbox in header, (3) Show floating action bar when items selected with delete button and count, (4) Add confirmation dialog before bulk delete, (5) Create backend endpoint `DELETE /api/v1/events/bulk` accepting array of event IDs, (6) Handle associated thumbnails cleanup on delete. | User Request | Done |
| BUG-003 | 2025-12-10 | P3 | Bug | **System Name Not Applied Everywhere** - When changing the system name in settings, not all references update. Fix locations: (1) Top-left corner logo/title in sidebar, (2) Browser tab title (document.title), (3) Any other hardcoded "ArgusAI" references. Implementation: Store system_name in React context or fetch from settings API, use dynamic value in Sidebar component and layout.tsx metadata. Ensure name updates immediately after settings save without page refresh. | User Request | Done |
| TD-002 | 2025-12-12 | P3 | Testing | **FeedbackButtons Component Tests** - Frontend tests for Story P4-5.1 FeedbackButtons component were deferred. Tests to write: (1) Test thumbs up click submits correct rating, (2) Test thumbs down click shows correction input, (3) Test correction input character limit (500), (4) Test selected state visual indicator, (5) Test loading state during submission, (6) Test success toast appears, (7) Test accessibility attributes (aria-label, keyboard navigation). Create `frontend/__tests__/components/events/FeedbackButtons.test.tsx`. | Story P4-5.1 | Done |
| TD-003 | 2025-12-14 | P3 | Testing | **Real Camera Integration Testing** - Test motion detection with diverse real-world footage. Acquire test footage: (1) Indoor/outdoor scenarios, (2) Different lighting conditions (day/night), (3) Various camera angles, (4) Edge cases: trees swaying, rain, shadows. Target: validate >90% person detection, <20% false positive rate. | Epic F2 Retrospective | Done |
| TD-004 | 2025-12-14 | P3 | Testing | **Performance Baseline Documentation** - Document actual CPU/memory usage with: (1) 1 camera @ 5 FPS + motion detection, (2) Different sensitivity levels, (3) MOG2 vs KNN vs frame-diff algorithms. Test on macOS (M1/Intel) and Linux (Ubuntu 22.04, 2-core VM). | Epic F2 Tech-Spec | Done |
| TD-005 | 2025-12-14 | P4 | Documentation | **Update README with Frontend Setup** - Add comprehensive frontend setup instructions: installation steps, environment configuration, development server commands. | F1.2 Code Review | Done |
| TD-006 | 2025-12-28 | P3 | Code Quality | **Remove Debug Console.log in API Client** - Remove `console.log('[API] Request to:', endpoint, ...)` at `lib/api-client.ts:203`. Debug logging left in production code. | Frontend Code Review | Open |
| TD-007 | 2025-12-28 | P3 | Testing | **Fix Test Type Mismatches** - Update 30+ test fixtures to match current TypeScript interfaces. Issues include: (1) ICamera missing `homekit_stream_quality` (required field), (2) IEntity missing `thumbnail_path` (required field), (3) ICorrelatedEvent missing `thumbnail_url` and `timestamp`, (4) Mock apiClient type mismatches. Affected files: CameraForm.test.tsx, CameraPreview.test.tsx, VirtualCameraList.test.tsx, EntityCard.test.tsx, EntityAlertModal.test.tsx, DeleteEntityDialog.test.tsx, AnalysisModeFilter.test.tsx, EventCard.test.tsx, EventDetailModal.test.tsx. | Frontend Code Review | Open |
| TD-008 | 2025-12-28 | P2 | Testing | **Fix Failing TunnelSettings Test** - Test `"starts tunnel with new token when Save is clicked"` fails at line 456. The apiClient.tunnel.start mock expectation is not being called correctly. | Frontend Code Review | Open |
| TD-009 | 2025-12-28 | P3 | Testing | **Create Shared Test Fixtures Factory** - Centralize test mocks in `__tests__/test-utils.tsx`. Current mockEvent and mockCamera factories are incomplete. Add: (1) Complete mockCamera with all required ICamera fields, (2) Complete mockEntity with all IEntity fields, (3) mockController for Protect tests, (4) mockApiClient with properly typed mock functions. | Frontend Code Review | Open |
| TD-010 | 2025-12-28 | P4 | Code Quality | **Clean Up Unused Test Imports** - Remove 9 unused imports in test files: (1) `vi` in AudioSettingsSection.test.tsx:7, (2) `container` in Sidebar.test.tsx:165, (3) `within` in AccuracyDashboard.test.tsx:21, (4) `userEvent` in CostDashboard.test.tsx:15, (5) `FrameSamplingStrategy` in FrameSamplingStrategySelector.test.tsx:8, (6) `fireEvent` in MQTTSettings.test.tsx:18, (7) `fireEvent` in GenerateSummaryDialog.test.tsx:14, (8) `waitFor` and `ConnectionStatus` in useWebSocket.test.ts:13-14. | Frontend Code Review | Open |
| TD-011 | 2025-12-28 | P1 | Code Quality | **CRITICAL: Fix asyncio.run() Misuse in mqtt_discovery_service.py** - Line 729 uses `asyncio.run(self._publish_discovery_on_connect())` in sync context. This creates a NEW event loop which will raise `RuntimeError` if called from existing async context. Fix: Replace with `asyncio.create_task()` or `asyncio.run_coroutine_threadsafe()`. | Backend Code Review | Open |
| TD-012 | 2025-12-28 | P2 | Code Quality | **Standardize Database Session Management** - 15+ instances of manual `db = SessionLocal()` → `db.close()` pattern instead of context managers. Files affected: `event_processor.py` (15+ instances), `camera_service.py`, `protect_event_handler.py`. Risk: If exception occurs before close(), connection leaks. Fix: Replace all with `with SessionLocal() as db:` context manager pattern. | Backend Code Review | Open |
| TD-013 | 2025-12-28 | P3 | Code Quality | **Reduce Singleton Pattern Boilerplate** - 50+ instances across 40+ files use identical singleton pattern with global variable + lock. Example: `_service_instance: Optional[ServiceClass] = None` with `get_service()` function. Files: `camera_service.py:773-787`, `snapshot_service.py:538-545`, `entity_service.py:1959-1966`, and 37+ more. Fix: Create `@singleton` decorator in utils to eliminate ~150 lines of duplicated code. | Backend Code Review | Open |
| TD-014 | 2025-12-28 | P3 | Code Quality | **Consolidate Exponential Backoff Logic** - 4 separate implementations of exponential backoff retry logic with different delays. Files: `camera_service.py:542`, `protect_service.py:35`, `webhook_service.py:49`, `mqtt_service.py:42`. Fix: Create shared `exponential_backoff()` utility function in `app/utils/` with configurable base/max delays. | Backend Code Review | Open |
| TD-015 | 2025-12-28 | P2 | Data Integrity | **Add Missing FK Constraint on WebhookLog.alert_rule_id** - `alert_rule.py:132-133` has `alert_rule_id` indexed but NOT a foreign key. Risk: Orphaned webhook logs when alert rules are deleted. Fix: Add `ForeignKey("alert_rules.id", ondelete="CASCADE")` and create Alembic migration. | Backend Code Review | Open |
| TD-016 | 2025-12-28 | P2 | Performance | **Add Missing Database Indexes** - Several frequently queried columns lack indexes: (1) Compound index `(source_type, timestamp)` on events table for Protect queries, (2) `recognized_entities.name` for LIKE queries in alert rules, (3) `devices.pairing_confirmed` for filtering inactive devices, (4) `api_keys.created_by` and `api_keys.revoked_by` FK columns, (5) Compound `(device_id, expires_at)` on pairing_codes for cleanup queries. | Backend Code Review | Open |
| TD-017 | 2025-12-28 | P3 | Code Quality | **Fix backref vs back_populates Inconsistency** - `face_embedding.py:95` and `vehicle_embedding.py:101` use legacy `backref` pattern instead of bidirectional `relationship` with `back_populates`. Inconsistent with other models. Fix: Change to `relationship("RecognizedEntity", back_populates="face_embeddings")` pattern. | Backend Code Review | Open |
| TD-018 | 2025-12-28 | P3 | Data Integrity | **Add Missing Check Constraints on Float Columns** - Several Float columns (0.0-1.0 or 0-100 range) lack check constraints: (1) `event.ai_confidence` (0-100) at line 85, (2) `event.anomaly_score` (0.0-1.0) at line 102, (3) `event.audio_confidence` (0.0-1.0) at line 109, (4) `camera.audio_threshold` (0.0-1.0) at line 88. Fix: Add CheckConstraints to `__table_args__`. | Backend Code Review | Open |
| TD-019 | 2025-12-28 | P3 | Code Quality | **Fix Timestamp Timezone Handling Inconsistency** - `system_setting.py:21` uses `server_default=func.now()` (server time) while all other models use `default=lambda: datetime.now(timezone.utc)` (Python UTC). Also, several DateTime columns lack `timezone=True` specification: `activity_summary.py` (period_start/end), `homekit.py`, `user.py`. Fix: Standardize on UTC Python defaults with timezone-aware columns. | Backend Code Review | Open |
| TD-020 | 2025-12-28 | P2 | API Standards | **Fix DELETE Endpoints Returning Wrong Status Code** - `cameras.py:507` DELETE returns 200 OK with JSON body instead of 204 NO CONTENT. Same issue in `notifications.py:184,209`. REST standard: DELETE should return 204 with no body on success. Fix: Change `status_code=status.HTTP_200_OK` to `status.HTTP_204_NO_CONTENT` and remove response body. | Backend Code Review | Open |
| TD-021 | 2025-12-28 | P2 | Input Validation | **Add UUID Validation on Path Parameters** - All UUID path parameters typed as `str` instead of `UUID`. Examples: `cameras.py:375` `camera_id: str`, all files with entity/rule/notification IDs. Risk: Invalid UUID strings accepted, causing 500 errors instead of 400/422. Fix: Change to `camera_id: UUID` from `uuid` module, add Path descriptions. | Backend Code Review | Open |
| TD-022 | 2025-12-28 | P3 | API Standards | **Standardize API Response Wrapper Format** - Protect API uses `{data: {...}, meta: {...}}` wrapper pattern while other APIs return models directly. Inconsistent developer experience. Options: (1) Add wrapper to all APIs for consistency, (2) Remove wrapper from Protect API, (3) Document the difference. Recommendation: Standardize on one pattern across all endpoints. | Backend Code Review | Open |
| TD-023 | 2025-12-28 | P1 | Security | **CRITICAL: Remove or Secure Debug Endpoints** - `system.py:53-119` exposes two dangerous debug endpoints in production: (1) `/debug/ai-keys` shows API key storage structure (encrypted prefixes, lengths), (2) `/debug/network` shows internal IP addresses (10.0.1.254) and RTSP URLs with credentials. Fix: Remove these endpoints entirely or add admin authentication + disable in production. | Backend Code Review | Open |
| TD-024 | 2025-12-28 | P2 | Security | **Implement API Rate Limiting** - No rate limiting visible on any endpoints. Comment at `cameras.py:966`: "TODO: implement rate limiting". Creates vulnerability to DoS attacks. Fix: Add rate limiting middleware using `slowapi` or similar, configure per-endpoint limits (e.g., 100 req/min for reads, 20 req/min for writes). | Backend Code Review | Open |
| TD-025 | 2025-12-28 | P3 | Code Quality | **Add Missing Relationship Objects in Notification Model** - `notification.py:30-31` has FKs for `event_id` and `rule_id` but no relationship objects defined. Must query via ID strings; can't access related objects efficiently. Fix: Add `event = relationship("Event")` and `rule = relationship("AlertRule")`. | Backend Code Review | Open |
| TD-026 | 2025-12-28 | P2 | Testing | **Add Unit Tests for protect_service.py** - Core WebSocket connection management service (122 LOC) has NO unit tests. Missing coverage: (1) `test_connection()` method, (2) WebSocket lifecycle management, (3) Reconnection logic with exponential backoff (BACKOFF_DELAYS = [1,2,4,8,16,30]), (4) Connection timeout handling (NFR3: 10 seconds), (5) Camera discovery caching (TTL: 60s), (6) Error handling for BadRequest, NotAuthorized, NvrError exceptions. | Backend Code Review | Open |
| TD-027 | 2025-12-28 | P2 | Testing | **Add Unit Tests for protect_event_handler.py** - Core event filtering pipeline (250+ LOC, Story P2-3.1) has NO unit tests. Missing coverage: (1) Event type parsing (motion, smart_detect_*, ring), (2) Filter chain evaluation, (3) Smart detection type filtering, (4) Cooldown deduplication logic, (5) HomeKit doorbell integration (Story P5-1.7), (6) Snapshot triggering coordination. | Backend Code Review | Open |
| TD-028 | 2025-12-28 | P2 | Testing | **Add Unit Tests for snapshot_service.py** - Concurrent snapshot retrieval service (180+ LOC) has NO unit tests. Missing coverage: (1) Semaphore-based concurrency limiting (max 3 concurrent per controller), (2) Timeout handling (1 second timeout), (3) Image resizing and thumbnail generation, (4) Resize dimension validation (1920x1080), (5) Base64 encoding pipeline, (6) Retry logic with 0.5s delays. | Backend Code Review | Open |
| TD-029 | 2025-12-28 | P3 | Testing | **Add Unit Tests for reprocessing_service.py** - Background job processing service (180+ LOC) has NO unit tests. Missing coverage: (1) Job status transitions (PENDING → RUNNING → COMPLETED), (2) Checkpoint/resume logic (NFR14), (3) Job cancellation during processing, (4) WebSocket progress updates, (5) Progress broadcast frequency. | Backend Code Review | Open |
| TD-030 | 2025-12-28 | P3 | Testing | **Add Unit Tests for websocket_manager.py** - Connection lifecycle management (181 LOC) has NO unit tests. Critical for real-time updates. Missing coverage: (1) Connection lifecycle (connect, disconnect, reconnect), (2) Message delivery reliability, (3) Broadcast message routing and ordering, (4) Connection cleanup on errors. | Backend Code Review | Open |
| TD-031 | 2025-12-28 | P3 | Testing | **Add Unit Tests for api_key_service.py** - API key management service (262 LOC) has NO unit tests. Missing coverage: (1) Key generation and hashing, (2) Key validation against hash, (3) Encryption/decryption of stored keys, (4) Key expiration checking, (5) Key revocation, (6) Prefix-based lookup. | Backend Code Review | Open |
| TD-032 | 2025-12-28 | P3 | Testing | **Increase Test Parametrization Adoption** - Only 11 `@pytest.mark.parametrize` instances in 3,424 tests. Many tests use verbose `for` loops with test case lists instead. Example: `test_ai_service.py` has object extraction tests that should be parametrized. Fix: Convert loop-based test cases to parametrized tests (target: 50+ parametrizations). Benefits: Better test isolation, clearer failure messages, easier to add cases. | Backend Code Review | Open |
| TD-033 | 2025-12-28 | P3 | Testing | **Consolidate Test Fixture Definitions** - Multiple test modules redefine `test_db`, `db_session`, `api_client`, `sample_event`, `sample_camera` fixtures. Duplication in `test_api/conftest.py` and individual test files. Fix: Create comprehensive shared fixtures in global `conftest.py`: (1) `sample_event` factory, (2) `sample_camera` factory, (3) `sample_rule` factory, (4) `sample_entity` factory. | Backend Code Review | Open |
| TD-034 | 2025-12-28 | P4 | Testing | **Add End-to-End Integration Tests** - No composite flow tests exist. Missing scenarios: (1) Camera capture → motion detection → AI description → alert → webhook complete flow, (2) Event correlation across multiple cameras, (3) Reprocessing job coordination with entity matching, (4) Protect event → entity matching → notification. | Backend Code Review | Open |
| TD-035 | 2025-12-28 | P3 | Testing | **Add Missing API Route Tests** - 12 API route modules (26%) have no test coverage: `audio`, `auth`, `api_keys`, `voice`, `motion_events`, `notifications`, `system_notifications`, `logs`, `mobile_auth`, `websocket`. Priority: auth and api_keys (security-critical), notifications (user-facing). | Backend Code Review | Open |

---

## Improvements

| ID | Date | Priority | Type | Description | Source | Status |
|----|------|----------|------|-------------|--------|--------|
| IMP-001 | 2025-12-06 | P4 | Code Quality | Remove console.log debug statements from EventCard.tsx (lines 104, 107) before production deployment | Story P3-3.4 Code Review | Done |
| IMP-004 | 2025-12-14 | P4 | Code Quality | **Accessibility Enhancements** - Improve frontend accessibility: (1) ~~Add ARIA labels for screen readers~~ (Done in Story P5-5.1, PR #52), (2) ~~Keyboard navigation testing~~ (Done in Story P5-5.2), (3) ~~Focus management in dialogs~~ (Verified - Radix handles this), (4) Skip to content links. | F1.2 Code Review | Partial (Epic P6-2) |
| IMP-005 | 2025-12-14 | P4 | Performance | **Camera List Optimizations** - If camera list grows large: (1) Add React.memo for CameraPreview component, (2) Virtual scrolling for large lists, (3) Consider SWR or React Query for caching. | F1.2 Code Review | Open (Epic P6-1) |
| IMP-006 | 2025-12-20 | P3 | UX | **Store & Display All Analysis Frames** - Download and persist all frames originally used for AI analysis (not just thumbnails). On event cards, make the display frame clickable to open a gallery view showing all frames that were analyzed. Implementation: (1) Store all extracted frames during analysis, (2) Add click handler on event thumbnail, (3) Open modal/lightbox with frame gallery, (4) Allow navigation between frames. | User Request | Done (P8-2.1, P8-2.2) |
| IMP-007 | 2025-12-20 | P3 | Settings | **Configurable Frame Count for Analysis** - Add option in Settings > General tab to set the number of frames to process during AI analysis. Options: 5, 10, 15, 20 frames. Implementation: (1) Add dropdown/select in General settings, (2) Show warning modal when changing value explaining that more frames = higher AI costs, (3) Store setting in system config, (4) Pass frame count to frame extraction service. | User Request | Done (P8-2.3) |
| IMP-008 | 2025-12-20 | P4 | UX | **Hide MQTT Form When Disabled** - When "Enable MQTT Integration" toggle is off, hide the rest of the MQTT/Home Assistant configuration form fields. Only show the full form when integration is enabled. Reduces visual clutter and makes it clear which settings are active. | User Request | Done (P8-3.1) |
| IMP-009 | 2025-12-21 | P2 | Infrastructure | **Configure SSL/HTTPS** - Add SSL/TLS support for secure connections. Required for push notifications (Web Push API requires secure context). Options: (1) Add Let's Encrypt/Certbot integration to install script, (2) Self-signed certificate generation, (3) Nginx reverse proxy with SSL termination, (4) Document manual certificate installation. Consider: certificate auto-renewal, port 443 configuration, HTTP to HTTPS redirect. | User Request | Done (P9-5.1) |
| IMP-010 | 2025-12-21 | P4 | UX | **Events Page Button Positioning** - Move the Select All, Refresh, and Delete buttons down slightly on the Events page to prevent overlap with the top-right navigation buttons. Adjust margin/padding to ensure clear separation between the action bar and header controls. | User Request | Done (P10-1.4) |
| IMP-011 | 2025-12-22 | P2 | Video Analysis | **Frame Capture Timing Optimization** - Investigate and fix timing offset in thumbnail and frame sequence capture. Current frames often miss the actual motion activity, capturing moments before or after the action. Investigation needed: (1) Analyze Protect event timing vs clip availability, (2) Determine optimal delay before frame extraction, (3) Consider using motion detection timestamps vs event start time, (4) Test different offset values for various event types (person, vehicle, package). Goal: Ensure captured frames show the actual activity that triggered the event. | User Request | Done (P9-2.1) |
| IMP-012 | 2025-12-22 | P3 | AI Prompt | **Add Camera Context and Time of Day to AI Prompt** - Enhance the AI description prompt by including which camera captured the event and the time of day. Implementation: (1) Extract timestamp/camera name from frame overlay if visible (many cameras embed this in the video), (2) Fall back to ArgusAI's own metadata (camera name from database, event timestamp) if overlay not readable or not present, (3) Include context in prompt like "This footage is from [camera name] at [time of day/date]", (4) Consider adding location context if camera has location field. Benefits: AI can provide more contextually relevant descriptions (e.g., "early morning activity at the front door"). | User Request | Done (P9-3.1, P9-3.2) |
| IMP-013 | 2025-12-22 | P3 | AI Accuracy | **Package Delivery False Positive Adjustment** - Add ability to adjust/tune package delivery detection when false positives occur. Implementation options: (1) Add "Not a package" correction option in feedback UI for package events, (2) Store package-specific false positive examples for prompt refinement, (3) Allow users to define what constitutes a package in their context (size, location, carrier uniforms), (4) Add confidence threshold setting specifically for package detection, (5) Consider adding negative examples to AI prompt ("Do not classify X as package delivery"). Use collected feedback data to improve package detection accuracy over time. | User Request | Done (P9-3.3) |
| IMP-014 | 2025-12-22 | P3 | AI Accuracy | **Summary Feedback and Custom Prompt** - Extend feedback and prompt customization to daily/activity summaries. Implementation: (1) Add thumbs up/down feedback buttons on summary cards (similar to event feedback), (2) Store summary feedback in database for accuracy tracking, (3) Add new "Summary Prompt" setting in Settings > AI Models tab for custom context prompt, (4) Add AI-assisted prompt refinement button for summary prompt (like FF-023 for event descriptions), (5) Include summary feedback data in AI Accuracy statistics. Allows users to improve summary quality through feedback and prompt customization. | User Request | Done (P9-3.4, P9-3.5, P9-3.6) |
| IMP-015 | 2025-12-22 | P3 | Entities | **Manual Entity Event Assignment** - Allow users to manually adjust which events are associated with each entity to improve accuracy. Implementation: (1) Add event list view on entity detail page showing all linked events, (2) Add "Remove from entity" button on each event to unlink misattributed events, (3) Add "Add to entity" option on event cards to assign events to existing entities, (4) Add "Move to different entity" to reassign events between entities, (5) Consider adding "Merge entities" to combine duplicates, (6) Store manual adjustments to improve future entity matching. Helps users correct entity grouping errors and train better entity recognition. | User Request | Done (P9-4.2, P9-4.3, P9-4.4, P9-4.5) |
| IMP-016 | 2025-12-22 | P3 | AI Architecture | **Local MCP Server for Enhanced AI Context** - Research and implement a local Model Context Protocol (MCP) server to provide additional context and data to AI models. Integration with feedback loops and entity adjustments: (1) Research MCP server implementation patterns and hosting options, (2) Design context data schema (user feedback history, entity corrections, known entities, location context), (3) Implement local MCP server that aggregates feedback loops, manual entity adjustments, and historical patterns, (4) Feed accumulated context to AI prompts for improved accuracy, (5) Consider storing: corrected descriptions, entity profiles, time-of-day patterns, camera-specific context, user preferences, (6) Evaluate performance impact and caching strategies. Goal: Create a learning system that improves AI accuracy over time using local context without cloud dependencies. Related: IMP-013, IMP-014, IMP-015, FF-023. | User Request | Done |
| IMP-017 | 2025-12-22 | P3 | Documentation | **Refactor README.md** - Update README.md to better reflect the current state of the project. Updates needed: (1) Revise feature list to include all implemented phases (Protect integration, video analysis, entities, summaries, push notifications, MQTT/Home Assistant), (2) Update screenshots if UI has changed significantly, (3) Refresh installation instructions to match current install script, (4) Add configuration examples for new features, (5) Update architecture diagram if applicable, (6) Review and update tech stack versions, (7) Add troubleshooting section for common issues, (8) Include links to detailed documentation in /docs folder. Ensure README accurately represents current capabilities for new users and contributors. | User Request | Done |
| IMP-018 | 2025-12-22 | P3 | UX | **Allow Feedback Adjustment** - Enable users to modify or change their previously submitted feedback on event descriptions. Implementation: (1) Add edit/change button next to existing feedback indicator, (2) Allow switching between thumbs up/down after initial submission, (3) Enable editing or removing correction text for thumbs down feedback, (4) Update backend to support feedback updates (PUT endpoint or upsert logic), (5) Show feedback history or "edited" indicator if feedback was changed, (6) Consider adding "Remove feedback" option to clear feedback entirely. Improves user experience when initial feedback was submitted in error or user changes their mind after review. | User Request | Done (P10-4.3) |
| BUG-013 | 2025-12-23 | P3 | Bug | **Entity Card Scrolling Issue** - Fix scrolling behavior on entity cards. Investigate and fix scrolling problems that affect user interaction with entity cards on the Entities page. Check: (1) ScrollArea component configuration, (2) CSS overflow properties, (3) Container height constraints, (4) Mobile vs desktop behavior. | User Report | Done (P10-1.5) |
| BUG-014 | 2025-12-23 | P2 | Bug | **Events Page Infinite Scroll Not Loading** - On the Events page, scrolling to the bottom continues scrolling but does not load additional events. Investigate: (1) Check infinite scroll/pagination hook (useInfiniteQuery or similar), (2) Verify intersection observer is triggering correctly, (3) Check if hasNextPage flag is being set properly from API response, (4) Verify fetchNextPage is being called on scroll, (5) Check API pagination parameters (offset/limit or cursor). Expected: New events should automatically load when user scrolls near the bottom of the list. | User Report | Done (P10-1.2) |
| BUG-015 | 2025-12-23 | P2 | Bug | **Today's Activity Shows All-Time Activity** - The "Today's Activity" section on the dashboard is displaying all-time activity instead of only events from the current day. Investigate: (1) Check dashboard API endpoint for date filtering, (2) Verify RecentActivity component is passing correct date range parameters, (3) Check if backend query includes proper date filtering (e.g., WHERE event_time >= today's start), (4) Verify timezone handling for day boundaries. Expected: Today's Activity should only show events from the current calendar day. | User Report | Done (P10-1.3) |
| IMP-023 | 2025-12-23 | P3 | UX | **Entity Assignment Without Opening Event** - Allow users to assign/change entity directly from event cards without needing to open the event detail modal. Implementation: (1) Add "Add to Entity" / "Move to Entity" button directly on EventCard component, (2) Open EntitySelectModal from the card level, (3) Remove requirement to click into event detail first. Benefits: Faster workflow for entity management, fewer clicks to accomplish common task. | User Request | Done (P10-4.1) |
| FF-031 | 2025-12-23 | P3 | Feature | **Manual Entity Creation** - Allow users to manually create entities without requiring an event to trigger creation. Implementation: (1) Add "Create Entity" button on Entities page, (2) Create EntityCreateModal with form fields: name, type (person/vehicle), optional description, (3) For vehicles: add color, make, model fields to generate signature, (4) Add POST /api/v1/context/entities endpoint for manual creation, (5) Allow uploading a reference image/thumbnail for the entity. Benefits: Users can pre-register known people/vehicles, create entities for items AI hasn't detected yet. | User Request | Done (P10-4.2) |
| IMP-024 | 2025-12-25 | P3 | AI Architecture | **MCP Phase 1: MCPContextProvider MVP** - Implement the foundational MCP context provider with feedback and entity context. Implementation: (1) Create `backend/app/services/mcp_context.py` with MCPContextProvider class, (2) Implement feedback history context gathering (recent feedback, camera accuracy, common corrections), (3) Add entity match context (matched entity info, similar entities), (4) Integrate with existing `context_prompt_service.py`, (5) Add parallel async query execution with <50ms target latency, (6) Implement fail-open error handling. Design: docs/research/mcp-server-research.md. Related: IMP-016, Story P10-6.1. | Story P10-6.1 Research | Done |
| IMP-025 | 2025-12-25 | P3 | AI Architecture | **MCP Phase 2: Full Context Integration** - Extend MCP context provider with camera and time pattern context. Implementation: (1) Add camera context (location hints, typical activity, false positive patterns), (2) Add time-of-day pattern context (activity levels, unusual timing detection), (3) Implement optional context caching with short TTL (60s), (4) Add metrics for context gathering performance, (5) Document context usage patterns in AI prompts. Design: docs/research/mcp-server-research.md. Related: IMP-016, IMP-024, Story P10-6.1. | Story P10-6.1 Research | Done |
| IMP-026 | 2025-12-25 | P3 | AI Architecture | **MCP Phase 3: Full MCP Protocol Compliance** - Implement full Model Context Protocol server using official SDK. Implementation: (1) Install `mcp[cli]` package, (2) Implement MCP resources (entities://, feedback://, patterns://), (3) Implement MCP tools (find_similar_events, get_event_context), (4) Implement MCP prompts (description_with_context template), (5) Enable external MCP client connections (optional - for Claude Desktop integration), (6) Add security layer for external access. Design: docs/research/mcp-server-research.md. Related: IMP-016, IMP-024, IMP-025, Story P10-6.1. | Story P10-6.1 Research | **Re-evaluate** (See IMP-065 - Review found Phase 3 not implemented) |
| IMP-027 | 2025-12-25 | P3 | Mobile | **Implement Mobile Device Registration** - Add device registration and management for mobile clients. Implementation: (1) Create Device model (device_id, platform, name, user_id, push_token, last_seen), (2) Add POST `/api/v1/devices` endpoint for registration, (3) Add GET `/api/v1/devices` to list user's devices, (4) Add DELETE `/api/v1/devices/{id}` for revocation, (5) Generate unique device pairing codes, (6) Associate push tokens with devices. Design: docs/api/mobile-auth-flow.md. Related: Story P10-5.2. | Story P10-5.2 Design | Done |
| IMP-028 | 2025-12-25 | P3 | Mobile | **Implement Token Refresh Endpoint** - Add dedicated token refresh for mobile clients. Implementation: (1) Add POST `/api/v1/auth/refresh` endpoint accepting expired (within grace period) JWT, (2) Return new JWT with extended expiration, (3) Implement sliding window expiration (refresh extends by 24h), (4) Add refresh token rotation for security, (5) Track refresh history per device, (6) Invalidate all tokens on password change. Design: docs/api/mobile-auth-flow.md. Related: Story P10-5.2, IMP-027. | Story P10-5.2 Design | Done |
| IMP-029 | 2025-12-25 | P2 | Infrastructure | **Implement Cloud Relay with Cloudflare Tunnel** - Enable secure remote access without port forwarding. Implementation: (1) Document cloudflared installation and configuration, (2) Add tunnel setup to install script as optional component, (3) Create `/api/v1/system/tunnel-status` endpoint to check connectivity, (4) Add Settings UI for tunnel configuration (enable/disable, tunnel token), (5) Implement automatic tunnel reconnection, (6) Add health monitoring for tunnel status. Design: docs/architecture/cloud-relay-architecture.md. Related: Story P10-5.3, FF-025. | Story P10-5.3 Design | Done |
| IMP-030 | 2025-12-25 | P2 | Mobile | **Implement APNS Provider for iOS Push** - Add Apple Push Notification Service support. Implementation: (1) Create APNSProvider class in `backend/app/services/push/`, (2) Implement HTTP/2 connection to APNS, (3) Add APNS auth key configuration (p8 file, key ID, team ID), (4) Create notification payload builder for iOS format, (5) Add POST `/api/v1/push/apns/register` for token registration, (6) Handle APNS error responses and token invalidation, (7) Support notification attachments (thumbnails). Design: docs/api/mobile-push-architecture.md. Related: Story P10-5.4. | Story P10-5.4 Design | Done |
| IMP-031 | 2025-12-25 | P2 | Mobile | **Implement FCM Provider for Android Push** - Add Firebase Cloud Messaging support. Implementation: (1) Create FCMProvider class in `backend/app/services/push/`, (2) Implement FCM HTTP v1 API integration, (3) Add FCM service account configuration (JSON key file), (4) Create notification payload builder for Android format, (5) Add POST `/api/v1/push/fcm/register` for token registration, (6) Handle FCM error responses and token refresh, (7) Support data messages for background processing. Design: docs/api/mobile-push-architecture.md. Related: Story P10-5.4, IMP-030. | Story P10-5.4 Design | Done |
| IMP-032 | 2025-12-25 | P2 | Mobile | **Unified Push Dispatch Service** - Create centralized push notification dispatcher. Implementation: (1) Create PushDispatchService to route to Web Push/APNS/FCM providers, (2) Query device tokens by user and apply notification preferences, (3) Implement parallel dispatch to all user devices, (4) Add retry logic with exponential backoff, (5) Track delivery status per device, (6) Handle quiet hours across time zones, (7) Support notification grouping/threading. Design: docs/api/mobile-push-architecture.md. Related: Story P10-5.4, IMP-030, IMP-031. | Story P10-5.4 Design | Done |
| IMP-033 | 2025-12-25 | P3 | AI Architecture | **Query-Adaptive Phase 1: Basic Frame Selection MVP** - Implement foundational query-adaptive frame selection using existing CLIP model. Implementation: (1) Add `encode_text(query: str)` method to existing EmbeddingService, (2) Create FrameEmbedding model with schema (event_id, frame_index, embedding JSON, model_version), (3) Add migration for frame_embeddings table, (4) Generate frame embeddings during frame extraction in event pipeline, (5) Add `POST /api/v1/events/{id}/smart-reanalyze?query=...` endpoint, (6) Implement cosine similarity scoring and top-K frame selection, (7) Integrate with existing re-analysis flow. Performance target: <60ms selection overhead. Design: docs/research/query-adaptive-frames-research.md. Related: FF-022, Story P10-6.2. | Story P10-6.2 Research | Done |
| IMP-034 | 2025-12-25 | P3 | AI Architecture | **Query-Adaptive Phase 2: Optimization** - Enhance query-adaptive selection with optimization features. Implementation: (1) Implement batch embedding generation for efficiency (~40% per-frame overhead reduction), (2) Add diversity filtering to prevent near-duplicate frame selection, (3) Integrate quality scoring (blur detection, exposure) with frame selection, (4) Add metrics for query matching effectiveness (relevance scores, selection distribution), (5) Implement query concept extraction for question-format queries ("Was there a package?" → "package"), (6) Add "a photo of {query}" formatting for single-word queries. Design: docs/research/query-adaptive-frames-research.md. Related: FF-022, IMP-033, Story P10-6.2. | Story P10-6.2 Research | Done |
| IMP-035 | 2025-12-25 | P3 | AI Architecture | **Query-Adaptive Phase 3: Advanced Features** - Add advanced query-adaptive capabilities. Implementation: (1) Multi-query support with OR logic for complex queries, (2) Query suggestions based on event type and smart detection, (3) A/B comparison mode: uniform vs adaptive selection for accuracy validation, (4) Optional faiss integration for large deployments (>10K frames), (5) Query result caching with TTL per event+query, (6) UI enhancements: show relevance scores, query input field on re-analyze modal. Design: docs/research/query-adaptive-frames-research.md. Related: FF-022, IMP-033, IMP-034, Story P10-6.2. | Story P10-6.2 Research | Done |
| IMP-036 | 2025-12-26 | P2 | Mobile | **Mobile App Device Pairing Code Flow** - Implement 6-digit pairing code authentication for native iOS/Android apps. Implementation: (1) Create PairingCode model (code, device_id, expires_at, confirmed, user_id), (2) Add POST `/api/v1/mobile/auth/pair` endpoint to generate 6-digit code with 5-min expiry, (3) Add POST `/api/v1/mobile/auth/verify` endpoint to exchange confirmed code for JWT tokens, (4) Create frontend "Confirm Pairing Code" UI in Settings > Devices section, (5) Add WebSocket notification when pairing code is generated (for real-time confirmation), (6) Implement code confirmation flow: user sees code on phone, enters/confirms on web dashboard, (7) Rate limit pairing attempts (5/min), (8) Add device info capture during pairing (device name, platform). Design: docs/api/mobile-api.yaml. Related: IMP-027, IMP-028, FF-024. | User Request | Done |
| IMP-038 | 2025-12-28 | P2 | Mobile | **Ensure Registered Devices Persist** - Verify and fix device registration persistence across server restarts. Implementation: (1) Confirm Device model is properly stored in database (not just in-memory), (2) Verify device records survive backend restarts, (3) Check push tokens are persisted and restored correctly, (4) Ensure pairing codes and device associations persist, (5) Add database migration if Device table doesn't exist, (6) Test persistence across Docker container restarts if applicable, (7) Add startup validation to reconnect/validate stored devices. Related: IMP-027 (Mobile Device Registration), IMP-036 (Mobile App Device Pairing). | User Request | Done |
| IMP-037 | 2025-12-26 | P3 | Alerts | **Entity-Based Alert Rules** - Allow users to create alert rules that trigger based on specific recognized entities. Implementation: (1) Add entity_id field to AlertRule model (nullable FK to RecognizedEntity), (2) Extend alert rule UI to optionally select a specific entity from dropdown, (3) Add entity filter condition in alert evaluation logic, (4) Support alerts like "Notify me when [John's Car] is detected" or "Alert when [Unknown Person] appears", (5) Allow combining entity filter with existing conditions (camera, time, detection type), (6) Consider adding "any unknown entity" option for stranger detection, (7) Add entity name display in alert rule list and notifications. Benefits: Personalized alerts for specific people/vehicles, stranger detection alerts, VIP arrival notifications. | User Request | Done |
| IMP-040 | 2025-12-28 | P3 | Code Quality | **Clean Up Unused Component Imports** - Remove 8 unused imports in component files: (1) `FormLabel` in AnalysisModeSelector.tsx:18, (2) `hasOvernightRange` variable in DetectionScheduleEditor.tsx:204, (3) `formatDateLabel` in SummaryCard.tsx:131, (4) `error` in SummaryCard.tsx:150, (5) `Checkbox` in EntityCard.tsx:17, (6) `useEntityEvents` in EntityDetail.tsx:22, (7) `entityName` in EventCard.tsx:82, (8) `AnalysisMode` in ReAnalyzeButton.tsx:22, (9) `getFilterCount` in EventTypeFilter.tsx:141, (10) `BarChart3` in APIKeySettings.tsx:26, (11) `getAccuracyBadgeVariant` in CameraAccuracyTable.tsx:35, (12) `ICostCapStatus` and `Progress` in CostCapSettings.tsx:27,34. | Frontend Code Review | Open |
| IMP-041 | 2025-12-28 | P2 | React Patterns | **Fix setState-in-useEffect Anti-patterns** - Refactor 5 components that call setState synchronously inside useEffect. This causes cascading renders and potential performance issues. Components: (1) `EntityMergeDialog.tsx:143` - use initializer function or useMemo instead, (2) `FrameGalleryModal.tsx:63` - reset state in open handler instead, (3) `ReAnalyzeModal.tsx:239` - use onOpenChange callback instead, (4) `AnalysisModePopover.tsx:87` - use controlled state pattern, (5) `EventTypeFilter.tsx:78` - compute from props instead of derived state. | Frontend Code Review | Open |
| IMP-042 | 2025-12-28 | P2 | React Patterns | **Extract SortIcon Component Outside Render** - Move `SortIcon` component definition outside of `CameraAccuracyTable` component (currently at line 89). Components created during render reset their state each time. Move to module scope or use useMemo for the render function. This causes 5 ESLint warnings for each usage. | Frontend Code Review | Open |
| IMP-043 | 2025-12-28 | P3 | Accessibility | **Add Alt Text to Images in BackupRestore** - Add meaningful alt attributes to `<img>` elements at `BackupRestore.tsx:335` and `BackupRestore.tsx:580` for screen reader accessibility. Use descriptive text or empty string for decorative images. | Frontend Code Review | Open |
| IMP-044 | 2025-12-28 | P3 | Performance | **Replace <img> with next/image Component** - Replace 4 native `<img>` elements with Next.js `<Image>` component for automatic optimization (lazy loading, responsive sizing, WebP conversion). Files: (1) `CameraForm.tsx:562`, (2) `RecentActivity.tsx:113`, (3) `EntityCreateModal.tsx:395`, (4) `NotificationDropdown.tsx:179`. | Frontend Code Review | Open |
| IMP-045 | 2025-12-28 | P4 | TypeScript | **Add Stricter TypeScript Checks** - Consider enabling stricter TypeScript compiler options for better type safety: (1) `noUncheckedIndexedAccess` - catches undefined access on arrays/objects, (2) `exactOptionalPropertyTypes` - stricter optional property handling. Will require fixing ~20-30 type errors but improves code reliability. | Frontend Code Review | Open |
| IMP-046 | 2025-12-28 | P3 | Testing | **Increase Test Coverage for Hooks** - Current coverage is good (806 tests passing) but hooks directory has limited tests. Add tests for: (1) useCameraDetail.ts, (2) useCameras.ts, (3) useFeedback.ts, (4) useFeedbackStats.ts, (5) useHomekitStatus.ts, (6) useInstallPrompt.ts, (7) useNotificationPreferences.ts, (8) usePromptInsights.ts, (9) usePushNotifications.ts, (10) useServiceWorker.ts, (11) useSummaries.ts, (12) useSummaryFeedback.ts, (13) useToast.ts. Only 5 of 18 hooks have test files. | Frontend Code Review | Open |
| IMP-047 | 2025-12-28 | P4 | Developer Experience | **Add React Query DevTools** - Install and configure `@tanstack/react-query-devtools` for development debugging. Shows query cache state, refetch triggers, and mutation status. Only enabled in development builds. Already using TanStack Query v5.90+. | Frontend Code Review | Open |
| IMP-048 | 2025-12-28 | P3 | Documentation | **Add Missing OpenAPI Summaries and Tags** - Most API endpoints missing `summary` and `tags` parameters to FastAPI decorators. Only some endpoints have summary (e.g., `discovery.py:75-79`). Fix: Add `summary="Create camera"`, `tags=["cameras"]` to all route decorators. Benefits: Better auto-generated API docs, easier navigation in Swagger UI. | Backend Code Review | Open |
| IMP-049 | 2025-12-28 | P3 | Input Validation | **Add Query Parameter Validation and Constraints** - Several issues: (1) Missing min validation on `limit` (should be >= 1), (2) Inconsistent defaults across APIs (`notifications.py:64` limit=20, others vary), (3) Date filtering uses `fromisoformat()` directly without helpful error messages (`ai.py:59`), (4) No sorting parameters on list endpoints (hard-coded `desc(created_at)`). Fix: Add `Query(ge=1, le=100)` constraints, standardize defaults, add sort/order parameters. | Backend Code Review | Open |
| IMP-050 | 2025-12-28 | P4 | Code Quality | **Create @singleton Decorator Utility** - To support TD-013 (singleton pattern boilerplate reduction). Implementation: Create `app/utils/decorators.py` with `@singleton` decorator that handles the global instance + lock pattern. Usage: `@singleton` on service class instead of manual `_instance` + `get_service()` pattern. | Backend Code Review | Open |
| IMP-051 | 2025-12-28 | P4 | Code Quality | **Create Shared Exponential Backoff Utility** - To support TD-014 (backoff duplication). Implementation: Create `app/utils/retry.py` with `async def exponential_backoff(attempt: int, base_delay: float = 1.0, max_delay: float = 60.0, jitter: bool = True) -> float`. Usage: Replace 4 separate implementations in camera_service, protect_service, webhook_service, mqtt_service. | Backend Code Review | Open |
| IMP-052 | 2025-12-28 | P3 | Performance | **Add Concurrency Tests for Critical Services** - Several services use semaphores/locks but lack concurrency tests: (1) snapshot_service.py - max 3 concurrent (semaphore exhaustion, queue blocking, timeout under load), (2) event_processor.py - async queue (stress tests, contention), (3) websocket_manager.py - broadcast ordering (race conditions). Add `pytest-asyncio` concurrent test scenarios. | Backend Code Review | Open |
| IMP-053 | 2025-12-28 | P4 | Logging | **Improve JSON Parse Error Handling** - `alert_engine.py:73-75,83-85` catches JSON parsing errors and returns empty dict silently. Could mask data corruption issues. Fix: Log warning with context (rule_id, field name) when JSON parsing returns fallback. Same issue in `webhook_service.py`. | Backend Code Review | Open |
| IMP-054 | 2025-12-28 | P3 | Testing | **Improve Mock Quality and Specifications** - Test mocks lack validation against real API contracts: (1) `test_protect.py` `make_smart_detect_enum()` creates partial enums not matching uiprotect behavior, (2) AI provider mocks don't test edge cases (token count accuracy, cost calculation, rate limiting headers), (3) Integration tests over-mock without validating real event flow. Fix: Add mock spec validation, contract tests. | Backend Code Review | Open |
| IMP-055 | 2025-12-29 | P2 | AI Architecture | **MCP: Integrate Entity Adjustments Context** - The EntityAdjustment model exists with 120 records in production but this data is completely unused in the MCP context system. Research doc (Section 3.1) specifies entity_corrections as part of the context schema to help AI learn from manual corrections. Implementation: (1) Add EntityAdjustment query to MCPContextProvider, (2) Create entity_corrections context component with original/corrected entity info, (3) Format corrections for AI prompt injection, (4) Add to AIContext dataclass. Impact: AI descriptions can learn from user corrections, improving accuracy over time. Related: IMP-016, IMP-024, docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-056 | 2025-12-29 | P2 | Performance | **MCP: Implement Parallel Query Execution** - MCPContextProvider runs 4 context queries sequentially instead of in parallel as specified in research doc (Section 4.3). Current: ~12ms total (sum of all queries). Target: ~4ms (max of all queries). Implementation: (1) Use `asyncio.gather()` with `return_exceptions=True` for parallel execution, (2) Wrap queries in `asyncio.wait_for()` with 80ms timeout, (3) Update metrics to track parallel vs sequential performance. Files: `app/services/mcp_context.py:288-300`. Related: IMP-016, docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-057 | 2025-12-29 | P2 | Code Quality | **MCP: Fix Async/Sync Database Query Mismatch** - MCPContextProvider methods are declared `async` but perform synchronous SQLAlchemy queries (e.g., `query.all()` blocks the event loop). Options: (1) Use SQLAlchemy async session with `await session.execute()`, (2) Run sync queries in executor using `asyncio.get_event_loop().run_in_executor()`. Blocking calls reduce concurrency and can cause latency spikes under load. Files: `app/services/mcp_context.py` (all `_get_*_context` methods). Related: docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-058 | 2025-12-29 | P3 | Performance | **MCP: Add Query Timeout Enforcement** - Research doc specifies 80ms hard timeout for context gathering but implementation has no timeout. Implementation: (1) Add `TIMEOUT_MS = 80` constant, (2) Wrap `get_context()` body in `asyncio.wait_for()`, (3) Log warning when timeout occurs, (4) Return partial context on timeout (fail-open). Related: IMP-056 (parallel queries), docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-059 | 2025-12-29 | P3 | Performance | **MCP: Investigate Low Cache Hit Ratio** - Production shows only 9.5% cache hit ratio (2 hits / 21 requests). Current cache key: `{camera_id}:{event_time.hour}`. Investigation needed: (1) Analyze event distribution across camera:hour combinations, (2) Consider shorter TTL with higher granularity keys, (3) Evaluate Redis for cross-restart persistence, (4) Add cache analytics metrics (key distribution, eviction rate). Related: docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-060 | 2025-12-29 | P3 | AI Quality | **MCP: Improve Pattern Extraction Algorithm** - Current `_extract_common_patterns()` uses hardcoded stop words and simple word frequency. Production shows extracted patterns like "frame, left, scene" which may not be meaningful. Options: (1) Add domain-specific stop words (security camera terminology), (2) Use TF-IDF instead of raw frequency, (3) Consider n-gram extraction for multi-word patterns, (4) Add minimum frequency threshold. Files: `app/services/mcp_context.py:845-882`. Related: docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-061 | 2025-12-29 | P3 | Feature | **MCP: Add VIP/Blocked Entity Context** - RecognizedEntity model has `is_vip` and `is_blocked` boolean fields but these are not included in MCP EntityContext. Implementation: (1) Add is_vip/is_blocked to EntityContext dataclass, (2) Include in entity query, (3) Format for AI prompt (e.g., "VIP: John - prioritize mentions" or "Blocked: ignore this person"). Related: docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-062 | 2025-12-29 | P4 | Feature | **MCP: Add Context Metrics Dashboard** - Research doc mentions tracking context usage and impact but only Prometheus metrics exist. Implementation: (1) Create Settings > AI > Context Metrics tab, (2) Show context hit/miss rates, average latency, component availability, (3) Add accuracy comparison (with/without context), (4) Display most common corrections and entity matches. Related: docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-063 | 2025-12-29 | P4 | Testing | **MCP: Implement Context A/B Testing** - Research doc mentions comparing description quality with/without context. Current implementation has ab_percentage setting but no metrics collection. Implementation: (1) Add accuracy tracking per ab_test_skip=true/false, (2) Create dashboard showing side-by-side comparison, (3) Add statistical significance calculation, (4) Allow per-camera A/B test configuration. Related: docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-064 | 2025-12-29 | P4 | Feature | **MCP: Track False Positive Frequency Patterns** - Research doc specifies false_positive_patterns should include frequency data (e.g., "tree shadow - daily at 3pm") but implementation only stores pattern text. Implementation: (1) Extend CameraContext to include frequency/timing for FP patterns, (2) Analyze feedback timestamps to detect recurring patterns, (3) Add time-of-day correlation to FP triggers. Related: docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-065 | 2025-12-29 | P4 | Infrastructure | **MCP: Enable External MCP Client Support** - Research doc (Phase 3) mentions Claude Desktop integration capability. Implementation: (1) Install `mcp[cli]` package, (2) Implement MCP resources (entities://, feedback://, patterns://), (3) Implement MCP tools (find_similar_events, get_event_context), (4) Add security layer (authentication, rate limiting), (5) Document external client setup. Note: IMP-026 marked "Done" but review found full MCP Protocol not implemented - only context provider exists. Related: IMP-026, docs/mcp-architecture-review.md. | MCP Architecture Review | Open |
| IMP-066 | 2025-12-29 | P2 | UX | **Entity Modal Scrolling for Assigned Events** - Add scrolling to the entity detail modal when viewing assigned events. Currently, if an entity has many assigned events, the modal content overflows or is cut off. Implementation: (1) Add max-height with overflow-y-auto to the events list container in EntityDetailModal, (2) Ensure modal itself has proper max-height constraint, (3) Consider virtual scrolling if event count is very large, (4) Maintain sticky header/footer if present. Files: `frontend/components/entities/EntityDetailModal.tsx` or similar. | User Request | Open |
| IMP-067 | 2025-12-29 | P2 | UX | **Entity Modal Event Click Opens Event Detail** - When clicking on an event in the entity modal, navigate directly to that specific event's detail view instead of just the events page. Implementation: (1) Add click handler to event items in entity modal, (2) Either open EventDetailModal with the selected event, or (3) Navigate to `/events?id={eventId}` with query param to auto-open detail, (4) Consider closing entity modal first or opening event detail as nested modal, (5) Ensure back navigation returns to entity view. Files: `frontend/components/entities/EntityDetailModal.tsx`. | User Request | Open |
| IMP-068 | 2025-12-29 | P3 | UX | **Consolidate Settings Form Save Patterns** - Settings pages have inconsistent save patterns: some use auto-save on change, some have Save buttons, some have per-section saves. Consolidate on a single pattern for consistency. Recommendation: Use explicit Save button at bottom of each settings tab. Implementation: (1) Audit all settings sections for save behavior, (2) Choose single pattern (explicit Save button recommended), (3) Add unsaved changes indicator/warning, (4) Implement "Save" and "Cancel/Reset" buttons consistently, (5) Show toast on successful save, (6) Warn before navigating away with unsaved changes. Files: `frontend/app/settings/`, `frontend/components/settings/`. | User Request | Open |
| IMP-069 | 2025-12-29 | P3 | Data Model | **Research: Multi-Entity Event Assignment** - Currently events can only be assigned to a single entity, but many events contain multiple entities (e.g., two people walking together, person with vehicle). Research and implement multi-entity support. Investigation: (1) Review current `matched_entity_ids` JSON field in Event model - may already support arrays, (2) Check EntityEvent junction table for many-to-many support, (3) Analyze AI description extraction for multiple entity detection, (4) Update entity matching to create multiple EntityEvent records. Implementation: (1) Ensure backend stores/returns multiple entity IDs per event, (2) Update frontend EventCard to show multiple entity badges, (3) Update entity detail to show events where entity appears (even with others), (4) Modify entity assignment UI to allow multi-select, (5) Update alert rules to trigger on any matched entity. Files: `backend/app/models/event.py`, `backend/app/services/entity_service.py`, `frontend/components/events/`. | User Request | Open |

---

## Future Features

| ID | Date | Priority | Type | Description | Source | Status |
|----|------|----------|------|-------------|--------|--------|
| FF-001 | 2025-12-08 | P3 | Troubleshooting | **Log Viewer UI** - Simple dashboard page to view and download logs for troubleshooting. Features: (1) View last 24 hours of backend logs, (2) Filter by log level (ERROR, WARNING, INFO, DEBUG), (3) Search/filter by text, (4) Download logs as file, (5) Auto-refresh option. Implementation: Store logs in SQLite or file rotation, add /api/v1/system/logs endpoint, build React component in Settings page. | User Request | Done |
| FF-002 | 2025-12-08 | P2 | UX | **Events Page Real-time Updates** - Add refresh capability to events page so new events appear without manual page reload. Options: (1) Manual refresh button with loading indicator, (2) WebSocket subscription to EVENT_CREATED messages (backend already broadcasts these), (3) Auto-refresh toggle with configurable interval. Recommended: Use existing WebSocket infrastructure - subscribe to EVENT_CREATED and prepend new events to list. | User Request | Done |
| FF-003 | 2025-12-08 | P2 | UX | **Show Camera Name on Event Cards** - Event cards currently display camera_id (UUID) instead of the human-readable camera name. Update EventCard component to show camera.name for better identification. Backend API already includes camera_name in EVENT_CREATED WebSocket messages and event responses - just need to use it in the frontend display. | User Request | Done |
| FF-004 | 2025-12-08 | P2 | Performance | **Move Camera Preview to Cameras Page** - Dashboard currently shows live camera previews which generates significant network traffic (frame polling). Move the live preview grid to the Cameras page instead. Dashboard should show only camera status info (name, online/offline, last event) without live video streams. This reduces API chatter when users are just viewing the main dashboard. | User Request | Won't Fix |
| FF-005 | 2025-12-08 | P3 | UX | **Mobile Navigation - Top Bar Only** - On mobile devices, show navigation only at the top of the page instead of sidebar. Hide the sidebar on small screens and use a hamburger menu or horizontal nav bar to clean up the interface and maximize content area. Use Tailwind responsive breakpoints (md:hidden, lg:block) to toggle between mobile top nav and desktop sidebar. | User Request | Done |
| FF-006 | 2025-12-08 | P2 | UX | **Dashboard Real-time Stats Update** - When a new event is created, update the "Total Events" and "Current Activity" cards on the dashboard in real-time. Subscribe to EVENT_CREATED WebSocket messages and increment counters without requiring page refresh. Can be implemented alongside FF-002 (Events Page Real-time Updates) using same WebSocket subscription pattern. | User Request | Done |
| BUG-001 | 2025-12-08 | P2 | Bug | **Export JSON/CSV Buttons Failing** - The export buttons on the events page are not working. Investigate and fix the /api/v1/events/export endpoint or frontend export functionality. Check: (1) API endpoint returning correct data format, (2) Frontend correctly calling export endpoint, (3) File download handling in browser. | User Report | Done |
| BUG-002 | 2025-12-08 | P3 | Bug | **Motion Events Not Captured from Protect** - Pure motion events (without smart detection) are not being captured. Investigation shows that `is_motion_currently_detected` flag is separate from `is_smart_detected` in Protect WebSocket. When smart detection occurs (person/vehicle), motion flag is False. Options: (1) Treat smart detections AS motion events (they all involve motion), (2) Add separate motion event polling, (3) Accept that smart detections are the primary event type and update camera config UI to clarify this. Note: This may be expected behavior - Protect prioritizes smart detection over raw motion. | Investigation | Done |
| FF-007 | 2025-12-08 | P3 | Feature | **Selective Backup/Restore Options** - Add granular selection for both backup and restore operations. Backup: Allow users to choose which components to include via checkboxes: (1) Database (events, cameras, alert rules), (2) Thumbnails/media files, (3) System settings, (4) AI provider configuration (API keys), (5) Protect controller config. Restore: Parse backup file to show available components, let user select which parts to restore (e.g., restore only settings without overwriting events). | User Request | Done |
| FF-008 | 2025-12-08 | P2 | DevOps | **Installation Script & Setup Wizard** - Create executable install script to automate application setup. Script should: (1) Check/install Python 3.11+, Node.js 18+, (2) Create virtual environment and install backend dependencies, (3) Install frontend dependencies and build, (4) Initialize database with migrations, (5) Generate encryption key, (6) Create systemd/launchd service files, (7) Configure reverse proxy (nginx) template. Manual setup items to document: (a) AI provider API keys (OpenAI, Gemini, Claude, Grok), (b) UniFi Protect controller credentials, (c) RTSP camera URLs and credentials, (d) SSL certificates for HTTPS, (e) Firewall/port forwarding for remote access. Include first-run setup wizard in UI for manual config items. | User Request | Done |
| IMP-002 | 2025-12-10 | P3 | UX | **Clean Up Event Card Duplicative Stats** - Event cards display redundant information that clutters the UI. Remove or consolidate duplicative stats including: (1) Confidence scoring shown in multiple places, (2) Identification/objects detected items that repeat, (3) Other redundant metadata. Streamline the event card layout to show essential info once in a clean, scannable format. | User Request | Done |
| FF-009 | 2025-12-10 | P2 | Feature | **Save & Display Multi-Frame Event Frames** - For events analyzed with multi-frame mode, persist the extracted frames so users can review them. Implementation: (1) Save key frames to filesystem alongside thumbnails during analysis, (2) Store frame paths/metadata in event record, (3) Add frame gallery UI when event card is expanded/selected, (4) Show frames in sequence with timestamps. This provides transparency into what the AI analyzed and helps users understand multi-frame descriptions. Note: Story P3-7.5 "Display Key Frames Gallery on Event Detail" in sprint-status covers similar scope. | User Request | Done |
| IMP-003 | 2025-12-10 | P3 | UX | **Remove Top Navigation on Desktop** - On desktop mode, the top navigation bar is redundant since the sidebar provides full navigation. Hide the top nav bar on larger screens (lg: breakpoint and above) to maximize content area and reduce visual clutter. Keep top nav visible only on mobile/tablet where sidebar is hidden. Use Tailwind responsive classes (lg:hidden) on the top nav component. | User Request | Done |
| FF-010 | 2025-12-10 | P2 | Feature | **Multi-Select Delete on Events Page** - Add ability to select multiple events and delete them in bulk. Implementation: (1) Add checkbox to each event card for selection, (2) Add "Select All" checkbox in header, (3) Show floating action bar when items selected with delete button and count, (4) Add confirmation dialog before bulk delete, (5) Create backend endpoint `DELETE /api/v1/events/bulk` accepting array of event IDs, (6) Handle associated thumbnails cleanup on delete. | User Request | Done |
| BUG-003 | 2025-12-10 | P3 | Bug | **System Name Not Applied Everywhere** - When changing the system name in settings, not all references update. Fix locations: (1) Top-left corner logo/title in sidebar, (2) Browser tab title (document.title), (3) Any other hardcoded "ArgusAI" references. Implementation: Store system_name in React context or fetch from settings API, use dynamic value in Sidebar component and layout.tsx metadata. Ensure name updates immediately after settings save without page refresh. | User Request | Done |
| FF-011 | 2025-12-14 | P3 | Feature | **Test Connection Before Save** - Backend enhancement to support temporary test endpoint (POST /cameras/test with body). This allows users to test RTSP connection before saving the camera, improving UX in the add camera flow. | F1.2 Code Review | Open (Epic P6-1) |
| FF-012 | 2025-12-14 | P2 | Feature | **MQTT 5.0 Features** - Consider support for MQTT 5.0 features: message expiry, shared subscriptions. Evaluate if these improve reliability or reduce broker load for high-volume event publishing. | P4-2 Tech-Spec | Done |
| FF-013 | 2025-12-14 | P3 | Feature | **MQTT Birth/Will Messages** - Implement MQTT birth (online) and will (offline) messages for connection monitoring. Allows Home Assistant to track ArgusAI connection state and create automations based on availability. | P4-2 Tech-Spec | Done |
| FF-014 | 2025-12-14 | P2 | Feature | **ONVIF Camera Discovery** - Auto-detect cameras on local network using ONVIF protocol. Reduces manual configuration for users with compatible cameras. Deferred from Phase 1 MVP. | Epic F1 Tech-Spec | Done |
| FF-015 | 2025-12-14 | P4 | Feature | **Audio Capture from Cameras** - Support audio streams from RTSP cameras for future audio-based event detection (glass break, doorbell ring, etc.). Out of scope for video AI analysis but enables future audio AI features. | Epic F1 Tech-Spec | Open (Epic P6-3) |
| FF-016 | 2025-12-14 | P3 | Feature | **Multiple Schedule Time Ranges** - Extend detection schedule to support multiple time ranges per day (e.g., 6-9am AND 6-11pm). Current implementation only supports single time range. User workaround: use two cameras or disable/enable manually. | Epic F2 Tech-Spec | Done |
| FF-017 | 2025-12-14 | P4 | Feature | **Export Motion Events to CSV** - Add CSV export functionality for motion events for external analysis. Include timestamp, camera, confidence, algorithm, bounding box coordinates. | Epic F2 Tech-Spec | Open (Epic P6-4) |
| FF-018 | 2025-12-14 | P3 | Feature | **Detection Zone Presets** - Provide preset zone templates for common use cases: "Full Frame", "Top Half", "Bottom Half", "Center", "L-shape". Reduces need for manual polygon drawing. | Epic F2 Tech-Spec | Done |
| FF-019 | 2025-12-20 | P3 | Feature | **Download & Store Full Motion Video** - Add toggle in Settings > General to enable downloading and storing full motion capture videos from Protect. Implementation: (1) Add toggle setting with storage warning, (2) Download motion clips when events are captured, (3) Store videos in data/videos folder with retention policy, (4) Add video icon/link on event cards when video is available, (5) Open modal with video player and download button. Consider storage implications and add disk usage monitoring. | User Request | Done (P8-3.2) |
| FF-020 | 2025-12-20 | P2 | Feature | **Adaptive Frame Sampling** - Implement content-aware frame selection instead of uniform sampling. Techniques: (1) Motion-based selection using optical flow or motion magnitude to prioritize high-activity frames, (2) Similarity/change detection via SSIM or histogram differences to skip redundant frames, (3) Scene change detection for shot boundaries. Benefits: 50-90% frame reduction while preserving key events, better accuracy for dynamic content (+1-5% in QA tasks), reduced AI costs. Start with similarity thresholding, then add motion scoring. | Research | Done (P8-2.4, P9-2.2, P9-2.3) |
| FF-021 | 2025-12-20 | P3 | Feature | **Configurable Frame Sampling Strategy** - Add settings option to choose frame sampling method: (1) Uniform - fixed interval/FPS (current default, simple), (2) Adaptive - content-aware selection prioritizing motion and changes, (3) Hybrid - uniform dense extraction followed by adaptive subsampling. Include brief explanation of tradeoffs (uniform = predictable cost, adaptive = better quality for dynamic scenes). Store in system config, pass to frame extraction service. | Research | Done (P8-2.5, P9-2.7) |
| FF-022 | 2025-12-20 | P4 | Feature | **Query-Adaptive Frame Selection** - For re-analysis or specific queries, score frames by relevance to the query using VL model embeddings. Prioritize frames that best answer the user's question rather than generic sampling. Useful for targeted re-analysis (e.g., "was there a package?"). Requires embedding comparison infrastructure. Design: docs/research/query-adaptive-frames-research.md. Related: Story P10-6.2, IMP-033, IMP-034, IMP-035. | Research | Done |
| FF-023 | 2025-12-20 | P2 | Feature | **AI-Assisted Prompt Refinement** - In Settings > AI Models tab, add button in AI Description Prompt section to refine the prompt using AI. Implementation: (1) Submit current prompt template + AI Accuracy feedback data (thumbs up/down, corrections) to position 1 AI provider, (2) Open modal displaying AI-suggested revised prompt, (3) Allow user to modify the suggestion, (4) Add "Resubmit" button to iterate on refinement, (5) "Accept" button to save new prompt. Helps users optimize prompts based on actual accuracy feedback without manual trial-and-error. | User Request | Done (P8-3.3) |
| FF-024 | 2025-12-20 | P3 | Feature | **Native Apple Device Apps** - Research and develop native applications for Apple ecosystem: (1) iPhone - push notifications, event viewing, camera controls, (2) iPad - dashboard with live previews, event timeline, (3) Apple Watch - notifications, quick glance complications, (4) Apple TV - full-screen camera grid, event review on big screen, (5) macOS - menu bar app, notification center integration. Consider SwiftUI for cross-platform code sharing, evaluate React Native as alternative. Research HomeKit integration for unified smart home experience. | User Request | Done |
| FF-025 | 2025-12-20 | P3 | Feature | **Cloud Relay for Remote Access** - Research and design a cloud-deployed relay service enabling secure connectivity between native Apple apps and local ArgusAI instance. Considerations: (1) Secure tunnel/WebSocket relay for NAT traversal, (2) Authentication and device pairing, (3) End-to-end encryption for privacy, (4) Cloud provider options (AWS, GCP, Cloudflare Tunnel, self-hosted), (5) Bandwidth optimization for thumbnails/video streaming, (6) Fallback to local network when available. Enables remote access without port forwarding or VPN. Dependency for FF-024 (Native Apple Apps). | User Request | Done (P11-1, P13-2) |
| BUG-004 | 2025-12-14 | P2 | Bug | **Feedback Status Not Persisting on Page Refresh** - User feedback (thumbs up/down) on event cards does not persist after page refresh. The feedback is submitted to the backend but the UI state is not restored when the page reloads. Fix: (1) Check if backend stores feedback correctly, (2) Ensure event API returns feedback status, (3) Initialize FeedbackButtons component with saved feedback state from event data. Related: Story P4-5.1 FeedbackButtons component. | User Report | Done |
| BUG-005 | 2025-12-20 | P2 | Bug | **Re-Analyse Function Returns Error** - The re-analyse function on event cards is throwing an error. Investigate and fix the endpoint or frontend call that triggers re-analysis of event descriptions. | User Report | Done (P8-1.1) |
| BUG-006 | 2025-12-20 | P2 | Bug | **Installation Script Fails on Non-ARM64 Systems** - The installation script is not working on non-arm64 based systems (x86_64/amd64). Investigate and fix architecture-specific dependencies or paths to support Intel/AMD processors. | User Report | Done |
| BUG-007 | 2025-12-20 | P2 | Bug | **Push Notifications Only Work Once** - Browser push notifications only work the first time they are triggered. Subsequent events do not send notifications. Investigate: (1) Service worker registration persistence, (2) Push subscription validity after first use, (3) Backend push sending logic for repeated notifications, (4) Browser notification permissions or throttling. | User Report | Done (P9-1.2) |
| BUG-008 | 2025-12-22 | P2 | Bug | **Protect Camera Filter Settings Not Persisting** - Camera event filter settings for Protect cameras are either not saving to the backend database or not persisting after page refresh. Investigate: (1) Check PUT `/api/v1/protect/controllers/{id}/cameras/{cam}/filters` endpoint is being called correctly, (2) Verify database model stores filter settings properly, (3) Check if frontend is reading saved filters on page load, (4) Verify filter state management in React components, (5) Test if changes are committed to database transaction. Filters include smart detection types (person, vehicle, package, animal, ring). | User Report | Done (P9-1.3) |
| BUG-009 | 2025-12-22 | P2 | Bug | **AI-Assisted Prompt Refinement Not Functional** - The AI-Assisted Prompt Refinement feature (FF-023) has multiple issues: (1) Refinement does not appear to actually submit to the AI provider when triggered, (2) Missing "Save" or "Replace Current Prompt" button to apply the refined prompt, (3) Modal does not display which AI model is being used for the refinement. Fixes needed: Verify API call is being made, add save/replace button with confirmation, show the AI provider/model name in the modal header or body. | User Report | Done (P9-1.5, P9-1.6, P9-1.7) |
| BUG-010 | 2025-12-22 | P1 | Bug | **GitHub Actions CI Tests Failing** - The CI pipeline tests in `.github/workflows/ci.yml` are failing again. Investigate: (1) Check which tests are failing in recent workflow runs, (2) Review recent code changes that may have broken tests, (3) Check for environment/dependency issues in CI runner, (4) Verify test fixtures and mocks are up to date, (5) Ensure CI environment matches local test environment. Fix failing tests to restore green builds. | User Report | Done (P9-1.1) |
| BUG-011 | 2025-12-22 | P2 | Bug | **Vehicle Entities Not Separating by Make/Model** - The entities feature is grouping all vehicle events together instead of creating separate entities for different vehicle makes and models. Investigate: (1) Check entity extraction logic for vehicles, (2) Verify AI description parsing correctly identifies make/model, (3) Ensure entity matching/clustering distinguishes between different vehicles, (4) Check if make/model fields are being stored in entity records, (5) Review entity similarity scoring for vehicle types. Expected behavior: Each unique vehicle (e.g., "White Toyota Camry", "Black Ford F-150") should be a separate entity with its own event history. | User Report | Done (P9-1.8) |
| BUG-012 | 2025-12-22 | P2 | Bug | **Cannot Change Admin Password Through UI** - The admin password change functionality in the Settings UI is not working. Investigate: (1) Check if password change form exists in Settings > Security or Account section, (2) Verify backend endpoint for password update (PUT /api/v1/auth/password or similar), (3) Check if form submission is calling the correct API endpoint, (4) Verify password validation and hashing on backend, (5) Check for error handling and user feedback on success/failure, (6) Ensure current password verification before allowing change. If password change UI doesn't exist, implement: password change form with current password, new password, confirm password fields. | User Report | Done (P10-1.1) |
| FF-026 | 2025-12-22 | P3 | Documentation | **GitHub Pages Project Site** - Create and build a GitHub Pages site for the ArgusAI project. Implementation: (1) Choose static site generator (Jekyll, Hugo, Docusaurus, or Next.js static export), (2) Design landing page with project overview, features, and screenshots, (3) Create documentation section from existing /docs content, (4) Add installation guide with copy-paste commands, (5) Include configuration reference and API documentation, (6) Add FAQ and troubleshooting pages, (7) Set up GitHub Actions workflow for automatic deployment on push to main, (8) Configure custom domain if desired, (9) Add SEO metadata and Open Graph tags. Goal: Professional public-facing documentation site for users and potential contributors. | User Request | Done |
| FF-027 | 2025-12-22 | P2 | DevOps/AI | **n8n Automated Development Pipeline** - Use n8n as an end-to-end solution for automated development, testing, refinement, and bug fixing. Implementation: (1) Set up self-hosted n8n instance, (2) Create workflows that integrate with Claude Code CLI for code generation and modifications, (3) Coordinate multiple AI models (OpenAI, Claude, Gemini) for code review, testing suggestions, and refinement, (4) Integrate with BMAD method workflows (create-story, dev-story, code-review, story-done), (5) Automate test execution and result analysis, (6) Create feedback loops for bug detection and automatic fix proposals, (7) Integrate with GitHub Actions for CI/CD triggers, (8) Build dashboards for pipeline monitoring and metrics, (9) Implement approval gates for human review when needed, (10) Add Slack/Discord notifications for pipeline status. Goal: Fully automated development experience from story creation through deployment with AI-assisted coding, testing, and refinement. Benefits: Reduced manual effort, consistent code quality, faster iteration cycles, 24/7 development capability. | User Request | Done (P13-5) |
| FF-028 | 2025-12-22 | P3 | Entities | **Manual Entity Grouping/Merging** - When a user manually identifies an entity, prompt them to group similar entities together. Implementation: (1) After manual entity identification, show prompt asking "Would you like to group this with similar entities?", (2) Display list of potentially similar entities (same type: person, vehicle, etc.) with thumbnails, (3) Allow multi-select of entities to merge/group together, (4) Merge selected entities into a single entity profile combining all associated events, (5) Use grouped entity data to improve future matching accuracy (store visual features, descriptions, common attributes), (6) Add "Group Entities" action on Entities list page for bulk grouping without triggering from identification flow, (7) Show grouping history on entity detail page, (8) Allow ungrouping/splitting if entities were incorrectly merged. Benefits: Improves entity recognition over time through user corrections, reduces duplicate entities, creates more complete entity profiles for better AI context. Related: IMP-015 (Manual Entity Event Assignment). | User Request | Done (P9-4.5) |
| FF-032 | 2025-12-24 | P3 | DevOps | **Docker & Kubernetes Support** - Add containerization support for easier deployment and scaling. Implementation: (1) Create Dockerfile for backend (Python/FastAPI), (2) Create Dockerfile for frontend (Next.js), (3) Create docker-compose.yml for local development and single-host deployment, (4) Add multi-stage builds for optimized production images, (5) Create Kubernetes manifests (Deployment, Service, ConfigMap, Secret, PVC for data persistence), (6) Add Helm chart for configurable K8s deployments, (7) Document environment variable configuration for containers, (8) Add health check endpoints for K8s probes, (9) Consider GPU passthrough for AI inference acceleration, (10) Add CI/CD workflow for building and pushing images to container registry. Benefits: Simplified deployment, reproducible environments, horizontal scaling capability, easier updates and rollbacks. | User Request | Done (P10-2, P10-3) |
| BUG-016 | 2025-12-25 | P2 | Bug | **MQTT Test Connection Returns 500 Error** - Testing MQTT connection in Settings throws a KeyError: "Attempt to overwrite 'message' in LogRecord". Root cause: The logging `extra` dict in `integrations.py:394` used `"message"` as a key, which is a reserved Python LogRecord attribute. Fix: Renamed to `"result_message"`. | User Report | Done |
| BUG-017 | 2025-12-25 | P2 | Bug | **MQTT Publish Discovery 404 Error** - Clicking "Publish Discovery" button returns 404. Root cause: Frontend API client called `/integrations/mqtt/discovery/publish` but backend endpoint is `/integrations/mqtt/publish-discovery`. Fix: Corrected the frontend API path. | User Report | Done |
| BUG-018 | 2025-12-25 | P3 | Bug | **EntitySelectModal Opens EventCard on Confirm** - Clicking Confirm in EntitySelectModal also opens the underlying EventCard. Root cause: Click event was propagating to parent EventCard. Fix: Added `e.stopPropagation()` to button handlers. | User Report | Done |
| BUG-022 | 2025-12-28 | P3 | Bug | **Event Detail Opens When Assigning Entity** - When adding an event to an entity via the entity selection UI, the event detail modal/page opens unnecessarily. Root cause: Entity list item click handler in EntitySelectModal didn't have stopPropagation, allowing clicks to bubble to parent EventCard. Fix: Added `e.stopPropagation()` to handleEntityClick and DialogContent onClick. | User Report | Done |
| BUG-019 | 2025-12-28 | P2 | Bug | **Registered Devices Only Show After Hard Refresh** - Newly registered/paired devices do not appear in the Settings > Devices UI until the page is hard refreshed. Root cause: Device record is created in `/exchange` endpoint (when mobile app exchanges code for tokens) AFTER web confirmation in `/confirm`. The query invalidation in confirm mutation was correct, but the Device didn't exist yet. Fix: Added `refetchInterval: 5000` to devices query in DeviceManager to poll for new devices, matching PairingConfirmation's polling pattern. | User Report | Done |
| BUG-020 | 2025-12-28 | P2 | Bug | **Events Not Auto-Assigned to Entities from AI Description** - Events are not being automatically added to recognized entities based on the AI description analysis. Root cause: In protect_event_handler.py, `match_or_create_entity` was called (creating EntityEvent junction records) but `event.matched_entity_ids` was never updated, so events appeared unlinked in UI. Fix: Added `event.matched_entity_ids = json.dumps([entity_result.entity_id])` after entity matching in both normal and no-AI fallback code paths. RTSP/USB events already worked via entity_alert_service. | User Report | Done |
| BUG-021 | 2025-12-28 | P2 | Bug | **AI Description Not Using Entity Context for Known People/Vehicles** - AI descriptions do not reference known entities by name (e.g., says "A man in blue jacket" instead of "John arrived"). Root cause: protect_event_handler.py had `matched_entity=None` hardcoded, so Protect camera events never got entity context in AI prompt. Fix: Added entity matching before context building - generates embedding from snapshot, calls match_entity_only(), passes result to build_context_enhanced_prompt(). RTSP/USB events already had this working in event_processor.py. | User Report | Done |
| FF-034 | 2025-12-28 | P3 | Feature | **Reprocess Events for Entity Matching** - Add ability to reprocess existing events to perform entity matching. Useful for: (1) Events created before entity matching was enabled/fixed, (2) Re-running matching after entity threshold changes, (3) Bulk entity assignment after creating new entities. Implementation: (1) Add POST `/api/v1/events/reprocess-entities` endpoint accepting optional filters (date range, camera, has_entity=false), (2) For each event: regenerate embedding if missing, call match_or_create_entity(), update matched_entity_ids, (3) Add progress tracking for large batches, (4) Add "Reprocess Entities" button in Settings > Entities or Events page, (5) Show confirmation with estimated event count, (6) Background task with WebSocket progress updates, (7) Option to only process events without existing entity matches. | User Request | Done (P13-3) |
| FF-033 | 2025-12-28 | P2 | Feature | **API Key Management for External Systems** - Add ability to generate and manage API keys for external system access. Implementation: (1) Create APIKey model (id, name, key_hash, prefix, scopes, created_at, expires_at, last_used, revoked), (2) Add POST `/api/v1/api-keys` endpoint to generate new keys (return full key only once), (3) Add GET `/api/v1/api-keys` to list keys (show prefix only, never full key), (4) Add DELETE `/api/v1/api-keys/{id}` to revoke keys, (5) Implement API key authentication middleware (check Authorization header for `Bearer ak_...` format), (6) Add scopes for granular permissions (read:events, write:cameras, admin, etc.), (7) Create Settings > API Keys UI page with key creation form, list of active keys, and revoke buttons, (8) Add key expiration support with optional auto-rotation, (9) Log API key usage for audit trail, (10) Rate limit per API key. Benefits: Enables secure third-party integrations, automation scripts, and external system access without exposing admin credentials. | User Request | Done (P13-1) |
| IMP-039 | 2025-12-28 | P3 | Branding | **Use ArgusAI Logo from graphics/ for App and Docs** - Replace placeholder icons with the argusai-image logo across the application and GitHub Pages documentation site. Implementation: (1) Export logo in required sizes (16x16, 32x32, 180x180, 512x512 for favicon and PWA icons), (2) Update frontend/public/ with favicon.ico, apple-touch-icon.png, and PWA manifest icons, (3) Update docs-site/static/img/ with logo.svg and favicon.ico for Docusaurus, (4) Update sidebar logo in frontend and docs-site, (5) Add Open Graph image for social sharing, (6) Ensure consistent branding across all platforms. | User Request | Done (P13-4) |
| FF-035 | 2025-12-29 | P3 | AI/UX | **AI Visual Annotation - Mark Detected Objects in Reference Frames** - Add visual annotations on reference frames showing which object/entity the AI identified. Implementation: Phase 1 - Basic bounding boxes: (1) AI returns bounding box coordinates with description, (2) Draw bounding box on reference frame before storing, (3) Store both original and annotated versions. Phase 2 - Enhanced annotations: (4) Label text showing entity type (person, vehicle, package), (5) Confidence score overlay, (6) Color-coded boxes by entity type, (7) Multiple entity support with numbered labels. Technical: OpenAI GPT-4o and Google Gemini have native bounding box support; Claude may need prompt engineering. Frontend: Toggle to show/hide annotations, compare original vs annotated view. Benefits: Improves AI transparency, helps users verify detection accuracy. | User Request | Open |

---

## GitHub Issues

All open backlog items have been created as GitHub issues for tracking:

| Backlog ID | GitHub Issue | Title |
|------------|--------------|-------|
| TD-002 | [#30](https://github.com/project-argusai/ArgusAI/issues/30) | FeedbackButtons Component Tests |
| TD-003 | [#31](https://github.com/project-argusai/ArgusAI/issues/31) | Real Camera Integration Testing |
| TD-004 | [#32](https://github.com/project-argusai/ArgusAI/issues/32) | Performance Baseline Documentation |
| TD-005 | [#33](https://github.com/project-argusai/ArgusAI/issues/33) | Update README with Frontend Setup |
| IMP-004 | [#34](https://github.com/project-argusai/ArgusAI/issues/34) | Accessibility Enhancements |
| IMP-005 | [#35](https://github.com/project-argusai/ArgusAI/issues/35) | Camera List Optimizations |
| FF-011 | [#36](https://github.com/project-argusai/ArgusAI/issues/36) | Test Connection Before Save |
| FF-012 | [#37](https://github.com/project-argusai/ArgusAI/issues/37) | MQTT 5.0 Features |
| FF-013 | [#38](https://github.com/project-argusai/ArgusAI/issues/38) | MQTT Birth/Will Messages |
| FF-014 | [#39](https://github.com/project-argusai/ArgusAI/issues/39) | ONVIF Camera Discovery |
| FF-015 | [#40](https://github.com/project-argusai/ArgusAI/issues/40) | Audio Capture from Cameras |
| FF-016 | [#41](https://github.com/project-argusai/ArgusAI/issues/41) | Multiple Schedule Time Ranges |
| FF-017 | [#42](https://github.com/project-argusai/ArgusAI/issues/42) | Export Motion Events to CSV |
| FF-018 | [#43](https://github.com/project-argusai/ArgusAI/issues/43) | Detection Zone Presets |
| BUG-004 | [#47](https://github.com/project-argusai/ArgusAI/issues/47) | Feedback Status Not Persisting on Page Refresh |
| IMP-009 | [#155](https://github.com/project-argusai/ArgusAI/issues/155) | Configure SSL/HTTPS |
| IMP-010 | [#153](https://github.com/project-argusai/ArgusAI/issues/153) | Events Page Button Positioning |
| IMP-016 | [#154](https://github.com/project-argusai/ArgusAI/issues/154) | Local MCP Server for Enhanced AI Context |
| IMP-017 | [#156](https://github.com/project-argusai/ArgusAI/issues/156) | Refactor README.md |
| IMP-018 | [#157](https://github.com/project-argusai/ArgusAI/issues/157) | Allow Feedback Adjustment |
| IMP-023 | [#158](https://github.com/project-argusai/ArgusAI/issues/158) | Entity Assignment Without Opening Event |
| BUG-012 | [#159](https://github.com/project-argusai/ArgusAI/issues/159) | Cannot Change Admin Password Through UI |
| BUG-013 | [#160](https://github.com/project-argusai/ArgusAI/issues/160) | Entity Card Scrolling Issue |
| BUG-014 | [#161](https://github.com/project-argusai/ArgusAI/issues/161) | Events Page Infinite Scroll Not Loading |
| FF-022 | [#162](https://github.com/project-argusai/ArgusAI/issues/162) | Query-Adaptive Frame Selection |
| FF-024 | [#163](https://github.com/project-argusai/ArgusAI/issues/163) | Native Apple Device Apps |
| FF-025 | [#164](https://github.com/project-argusai/ArgusAI/issues/164) | Cloud Relay for Remote Access |
| FF-026 | [#165](https://github.com/project-argusai/ArgusAI/issues/165) | GitHub Pages Project Site |
| FF-027 | [#166](https://github.com/project-argusai/ArgusAI/issues/166) | n8n Automated Development Pipeline |
| FF-031 | [#167](https://github.com/project-argusai/ArgusAI/issues/167) | Manual Entity Creation |
| FF-035 | [#278](https://github.com/project-argusai/ArgusAI/issues/278) | AI Visual Annotation - Mark Detected Objects |
| IMP-066 | [#279](https://github.com/project-argusai/ArgusAI/issues/279) | Entity Modal Scrolling for Assigned Events |
| IMP-067 | [#297](https://github.com/project-argusai/ArgusAI/issues/297) | Entity Modal Event Click Opens Event Detail |
| IMP-068 | [#300](https://github.com/project-argusai/ArgusAI/issues/300) | Consolidate Settings Form Save Patterns |
| IMP-069 | [#302](https://github.com/project-argusai/ArgusAI/issues/302) | Research: Multi-Entity Event Assignment |

**GitHub Labels Created:**
- `technical-debt`, `testing`, `frontend`, `backend`, `performance`, `feature`, `integration`
- `P2-high`, `P3-medium`, `P4-low`

---

## Notes

- Items are added during code reviews, retrospectives, and development
- Priority should be reassessed during sprint planning
- Status: Open, In Progress, Done, Won't Fix
- When adding new open items, create corresponding GitHub issue and add to mapping table above
